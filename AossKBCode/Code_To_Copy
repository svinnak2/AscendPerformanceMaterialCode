import boto3
import requests
from requests_aws4auth import AWS4Auth

# Path to the AWS credentials file
credentials_file_path = './aws/credentials'

# AWS Profile and Region
profile_name = "default"  # Replace with the profile name in your credentials file
region = "us-east-1"      # Replace with your API Gateway's region
service = "execute-api"   # AWS service for API Gateway

# API Gateway endpoint
api_url = "https://your-api-id.execute-api.region.amazonaws.com/stage/resource"  # Replace with your API Gateway URL

# Create a session using credentials from the file
session = boto3.Session(profile_name=profile_name, region_name=region)
credentials = session.get_credentials()

aws_access_key = credentials.access_key
aws_secret_key = credentials.secret_key
aws_session_token = credentials.token  # This might be None if not using temporary credentials

# Create AWS4Auth object
aws_auth = AWS4Auth(aws_access_key, aws_secret_key, region, service, session_token=aws_session_token)

# Make GET request
response = requests.get(api_url, auth=aws_auth)

# Print response
print("Status Code:", response.status_code)
print("Response Body:", response.text)
