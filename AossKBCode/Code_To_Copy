import boto3

# Initialize the S3 client
s3 = boto3.client('s3')

# Define the bucket name and folder key
bucket_name = 'MyS3_Bucket'
prefix = 'PublicFolder/BOA/Pdf_file/'

# Function to list the S3 URIs of files within the specified key
def list_s3_uris(bucket, prefix):
    response = s3.list_objects_v2(Bucket=bucket, Prefix=prefix)

    # Check if the bucket contains objects
    if 'Contents' in response:
        for obj in response['Contents']:
            s3_uri = f"s3://{bucket}/{obj['Key']}"
            print(s3_uri)
    else:
        print("No files found in the specified folder.")

# Call the function to list the S3 URIs
list_s3_uris(bucket_name, prefix)


{'ResponseMetadata': {'RequestId': 'B4DCSJZS19E39766', 'HostId': '61DU4PLmpsJyGCICNn4rLVuvUilb0kXAVh90vgCrxtz2r170uRHoDiC3R9kgShSGm/xEK9HmEst524xdQm3qTFKtVaaWH32/3/Y1izXnjKI=', 'HTTPStatusCode': 200, 'HTTPHeaders': {'x-amz-id-2': '61DU4PLmpsJyGCICNn4rLVuvUilb0kXAVh90vgCrxtz2r170uRHoDiC3R9kgShSGm/xEK9HmEst524xdQm3qTFKtVaaWH32/3/Y1izXnjKI=', 'x-amz-request-id': 'B4DCSJZS19E39766', 'date': 'Wed, 02 Oct 2024 20:15:19 GMT', 'x-amz-bucket-region': 'us-east-1', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'server': 'AmazonS3'}, 'RetryAttempts': 0}, 'IsTruncated': False, 'Contents': [{'Key': 'Public_Data/BOA/Pdf_Split_Working_Dir/', 'LastModified': datetime.datetime(2024, 10, 2, 20, 7, 18, tzinfo=tzlocal()), 'ETag': '"d41d8cd98f00b204e9800998ecf8427e"', 'Size': 0, 'StorageClass': 'STANDARD'}, {'Key': 'Public_Data/BOA/Pdf_Split_Working_Dir/Community_Impact_page_42-47.pdf', 'LastModified': datetime.datetime(2024, 10, 2, 20, 11, 37, tzinfo=tzlocal()), 'ETag': '"1027ac9778404ea6db0865b100a22716"', 'Size': 596231, 'StorageClass': 'STANDARD'}, {'Key': 'Public_Data/BOA/Pdf_Split_Working_Dir/Company_Performance_page_4-17.pdf', 'LastModified': datetime.datetime(2024, 10, 2, 20, 11, 37, tzinfo=tzlocal()), 'ETag': '"e47fa9e3961d662f6d47175b320a64df"', 'Size': 1787022, 'StorageClass': 'STANDARD'}, {'Key': 'Public_Data/BOA/Pdf_Split_Working_Dir/Financial_Review_2023_page_79-142.pdf', 'LastModified': datetime.datetime(2024, 10, 2, 20, 11, 38, tzinfo=tzlocal()), 'ETag': '"02e42f469d6d0983db952966e4761eab"', 'Size': 2462896, 'StorageClass': 'STANDARD'}, {'Key': 'Public_Data/BOA/Pdf_Split_Working_Dir/Human_Capital_Management_Update_page_48-78.pdf', 'LastModified': datetime.datetime(2024, 10, 2, 20, 11, 39, tzinfo=tzlocal()), 'ETag': '"8767c54344ab5d98c538707c8d8bce53"', 'Size': 4641312, 'StorageClass': 'STANDARD'}, {'Key': 'Public_Data/BOA/Pdf_Split_Working_Dir/Local_International_Digital_Spotlights_page_36-41.pdf', 'LastModified': datetime.datetime(2024, 10, 2, 20, 11, 41, tzinfo=tzlocal()), 'ETag': '"1942311cc2ac466408dcef328abcdd56"', 'Size': 1072038, 'StorageClass': 'STANDARD'}, {'Key': 'Public_Data/BOA/Pdf_Split_Working_Dir/lines_of_business_page_18-35.pdf', 'LastModified': datetime.datetime(2024, 10, 2, 20, 11, 40, tzinfo=tzlocal()), 'ETag': '"760c2ad940e40982200f05470298a1c6"', 'Size': 1882917, 'StorageClass': 'STANDARD'}], 'Name': 'scopememo-genai-ssv', 'Prefix': 'Public_Data/BOA/Pdf_Split_Working_Dir/', 'MaxKeys': 1000, 'EncodingType': 'url', 'KeyCount': 7}
{'Key': 'Public_Data/BOA/Pdf_Split_Working_Dir/', 'LastModified': datetime.datetime(2024, 10, 2, 20, 7, 18, tzinfo=tzlocal()), 'ETag': '"d41d8cd98f00b204e9800998ecf8427e"', 'Size': 0, 'StorageClass': 'STANDARD'}
