import os
import re
from datetime import datetime

# Directory path
directory_path = "/home/CodeFiles/"

# Map of month names to numeric values
month_map = {
    "Jan": "01", "Feb": "02", "Mar": "03", "Apr": "04", "May": "05", "Jun": "06",
    "Jul": "07", "Aug": "08", "Sep": "09", "Sept": "09", "Oct": "10", "Nov": "11", "Dec": "12"
}

# Function to extract date from filename
def extract_date(filename):
    # Look for patterns like YYYYMMDD, MMDDYY, or MonthYYYY
    patterns = [
        r"(\d{8})",          # Matches YYYYMMDD
        r"(\d{6})",          # Matches MMDDYY
        r"(\b\d{4}\b)",      # Matches standalone year YYYY
        r"([A-Za-z]+)(\d{4})"  # Matches MonthYYYY (e.g., Sept2024)
    ]
    for pattern in patterns:
        match = re.search(pattern, filename)
        if match:
            try:
                # Try to parse YYYYMMDD
                if len(match.group(0)) == 8:
                    return datetime.strptime(match.group(0), "%Y%m%d")
                # Try to parse MMDDYY
                elif len(match.group(0)) == 6:
                    return datetime.strptime(match.group(0), "%m%d%y")
                # Parse standalone year
                elif len(match.group(0)) == 4:
                    return datetime.strptime(match.group(0), "%Y")
                # Parse MonthYYYY
                elif len(match.groups()) == 2:
                    month, year = match.groups()
                    if month[:3] in month_map:
                        month_num = month_map[month[:3]]
                        return datetime.strptime(f"{year}{month_num}01", "%Y%m%d")
            except ValueError:
                continue
    return datetime.max  # Default for files with no recognizable date (sorted last)

# List all files in the directory
files = [f for f in os.listdir(directory_path) if os.path.isfile(os.path.join(directory_path, f))]

# Sort files by extracted date in ascending order
sorted_files = sorted(files, key=extract_date)

# Print sorted files
print("Files Sorted by Ascending Date:")
for file in sorted_files:
    print(file)
