from docx import Document

def add_paragraph_to_section(doc_path, section_title, new_paragraph_text, output_path):
    # Load the Word document
    doc = Document(doc_path)

    # Initialize a flag to determine if we are in the target section
    in_target_section = False

    # Iterate through the paragraphs in the document
    for paragraph in doc.paragraphs:
        # Check if the paragraph matches the section title
        if section_title.lower() in paragraph.text.lower():
            in_target_section = True
            continue  # Skip the title itself
        
        # If we are in the target section, add the new paragraph
        if in_target_section:
            if paragraph.text.strip() == "":  # End of the section
                paragraph.insert_paragraph_before(new_paragraph_text)
                in_target_section = False
                break

    # Save the updated document
    doc.save(output_path)
    print(f"Paragraph added to section '{section_title}' and saved as '{output_path}'.")

# Usage
doc_path = "example.docx"  # Path to the input Word document
section_title = "About company and its history"
new_paragraph_text = "Our company was founded in 1990 and has been a leader in innovation ever since."
output_path = "updated_example.docx"  # Path to the output Word document

add_paragraph_to_section(doc_path, section_title, new_paragraph_text, output_path)
