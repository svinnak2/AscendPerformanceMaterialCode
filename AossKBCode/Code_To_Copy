import xml.etree.ElementTree as ET

# Load the XML file
xml_file_path = "/mnt/data/COMPTIME.XML"  # Adjust path if needed
tree = ET.parse(xml_file_path)
root = tree.getroot()

# Define tags to extract
tags_to_extract = ["SOURCE", "TRANSFORMATION", "TARGET"]

# Iterate through specified tags
for tag in tags_to_extract:
    for element in root.findall(f".//{tag}"):
        name_attr = element.get("NAME")  # Extract NAME attribute
        if name_attr:
            file_name = f"{name_attr}.xml"  # Create file name

            # Convert the XML element to string format
            element_string = ET.tostring(element, encoding="unicode")

            # Save to a new file
            with open(file_name, "w", encoding="utf-8") as file:
                file.write(f'<?xml version="1.0" encoding="UTF-8"?>\n')
                file.write(element_string)

            print(f"âœ… Extracted and saved: {file_name}")
