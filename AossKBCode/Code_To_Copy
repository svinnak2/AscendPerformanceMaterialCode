import xml.etree.ElementTree as ET
import os

# ‚úÖ Define XML file path
xml_file_path = "/home/ec2/your-informatica.xml"  # Change to your actual file path
output_file_path = "/home/ec2/connectors.txt"  # Change to your desired output path

# ‚úÖ Parse the XML file
try:
    tree = ET.parse(xml_file_path)
    root = tree.getroot()

    # ‚úÖ Open output file for writing
    with open(output_file_path, "w", encoding="utf-8") as output_file:

        # ‚úÖ Iterate through <MAPPING> elements
        for mapping in root.findall(".//MAPPING"):
            mapping_name = mapping.get("NAME")  # Extract MAPPING NAME attribute

            # ‚úÖ Ignore mappings with NAME="mplt_MD5_Hash_Key"
            if mapping_name == "mplt_MD5_Hash_Key":
                print(f"üö´ Ignoring mapping: {mapping_name}")
                continue  # Skip this mapping

            print(f"‚úÖ Processing mapping: {mapping_name}")
            output_file.write(f"Mapping: {mapping_name}\n")  # Write mapping name in output file

            # ‚úÖ Extract <CONNECTOR> elements from this mapping
            connectors = mapping.findall(".//CONNECTOR")

            for connector in connectors:
                connector_str = ET.tostring(connector, encoding="unicode").strip()
                print(connector_str)  # Print extracted CONNECTOR elements
                output_file.write(connector_str + "\n")  # Save to file

            output_file.write("\n")  # Add newline between mappings for readability

    print(f"‚úÖ All CONNECTOR elements saved to: {output_file_path}")

except Exception as e:
    print(f"‚ùå Error processing XML file: {e}")
